<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="zh_CN">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>新手入门 &#8212; xtest-wiki 17.6.6.1 文档</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '17.6.6.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="prev" title="欢迎查看”Xtest系统“帮助文档" href="../index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1>新手入门<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h1>
<div class="section" id="id2">
<h2>前言<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<p>在正式开始本文的长篇大论前，有必要综述一下本文的内容。</p>
<ol class="arabic simple">
<li>展示了一种 <strong>测试量化开发</strong> 和 <strong>测试驱动开发</strong> 的工作流</li>
<li>陈述了一些关于自动化测试的基本概念</li>
<li>强调了一些必要的良好规范的开发习惯</li>
<li>提出了一种自动化测试报告的报文格式</li>
<li>给出了一种测试报告内容的提取的方法（以python下的测试框架pyunit为例子）</li>
<li>介绍了一种pyunit和自动化报告平台的数据对接方法</li>
</ol>
<p>最终希望本文能够给测试开发从业人员一些启示，同时本文提到的系统能够让：</p>
<ol class="arabic simple">
<li>注重软件质量</li>
<li>有条件做自动化测试</li>
</ol>
<p>的软件公司形成良好的开发过程，成就自己高效透明的开发信息流。</p>
</div>
<div class="section" id="id3">
<h2>软件开发工作流<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h2>
<p>大家都试着构想过这样一种工作流：</p>
<ol class="arabic simple">
<li>小组成员一起开会设计好系统</li>
<li>定义好接口并形成书面文档</li>
<li>开发人员负责 <strong>软件功能项目</strong> 和测试人员负责 <strong>测试用例项目</strong>，同步开发</li>
<li>长时间的小步快速开发和迭代，功能和用例数都不断增长</li>
<li>功能项目的目标是让所有的测试用例都通过</li>
<li>最终达成团队的预期目标，项目上线</li>
</ol>
<p>工程流程图如下：</p>
<img alt="../_images/xtest-work-flow.png" src="../_images/xtest-work-flow.png" />
<p>以上工作流的好处如下：</p>
<ol class="arabic simple">
<li>开发和测试同步进行，人员得到最大化利用</li>
<li>让小步和快速迭代上线成为可能，极大降低了项目无谓的消耗和项目失败的风险</li>
<li>每个过程都严格的让测试用例对软件质量进行了有效把控</li>
<li>测试用例的总数和成功总数对软件这个黑盒形成了良好的 <strong>量化</strong></li>
<li>整个开发过程和进度对于 <strong>不懂技术</strong> 的团队成员也是 <strong>完全透明</strong> 的</li>
</ol>
<p>整个过程用两句话可以描述：</p>
<ol class="arabic simple">
<li>测试 <strong>驱动</strong> 开发</li>
<li>测试 <strong>量化</strong> 开发</li>
</ol>
<p>当然，一个IT企业，做到以上是非常不容易的，但是可以朝向这个方向不断前进。</p>
<p>本文先介绍一个系统来助力IT企业实现这一目标。在实现这一目标之前，先达成一个小目标：</p>
<p>让企业重视软件质量，提升软件质量控制的 <strong>技术和方法论</strong> ，让软件测试活动变得 <strong>流行</strong> 起来，让软件测试成为整体软件生产活动中的 <strong>高频事件</strong> 。</p>
<p>为了上述的小目标落地，那么先要到如下几点：</p>
<ol class="arabic simple">
<li>让软件测试工作确实起到 <strong>量化</strong> 开发过程的作用</li>
<li>加速测试重要产出物 <strong>*测试报告</strong> 的曝光度和传播度</li>
</ol>
<p>借助 <strong>xtest系统</strong> 可以有效实现这个目标：</p>
<ol class="arabic simple">
<li>测试开发人员完成自动化测试项目的编写</li>
<li>提取测试项目的报告</li>
<li>按照 <strong>xtest系统</strong> 组织成 <strong>规范的报告格式</strong></li>
<li>上传测试报告到 <strong>xtest系统</strong></li>
<li>根据时间线形成完整的 <strong>产品成长量化图</strong></li>
<li>形成直观的 <strong>测试报告分享报表</strong>，直接分享给协作人员查看</li>
</ol>
<p>具体效果如后文所示。</p>
</div>
<div class="section" id="xtest">
<h2>xtest系统演示<a class="headerlink" href="#xtest" title="永久链接至标题">¶</a></h2>
<p>形成稳定的产品测试线路图：</p>
<img alt="../_images/xtest-list-share.png" src="../_images/xtest-list-share.png" />
<p>对测试记录生成 <strong>分享链接</strong> ，供其他非登录用户直接进行访问：</p>
<img alt="../_images/xtest-share-gen.png" src="../_images/xtest-share-gen.png" />
<p><a class="reference external" href="http://xtest.apiapp.cc/utest-report-share.html?stoken=b40a587c362a11e7856f00163e006b26">示例链接地址</a></p>
<div class="code highlight-default"><div class="highlight"><pre><span></span>http://xtest.apiapp.cc/utest-report-share.html?stoken=b40a587c362a11e7856f00163e006b26
</pre></div>
</div>
<p>被分享和传播的精美测试报告：</p>
<img alt="../_images/xtest-share-report.png" src="../_images/xtest-share-report.png" />
<p>可以任意邮件或者QQ微信进行分享和传播，极大的提高了报告的 <strong>可读性和传播性</strong>。</p>
<p>系统试用 <a class="reference external" href="http://xtest.apiapp.cc/login.html">地址</a> ：</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">xtest</span><span class="o">.</span><span class="n">apiapp</span><span class="o">.</span><span class="n">cc</span><span class="o">/</span><span class="n">login</span><span class="o">.</span><span class="n">html</span>
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h2>测试的概念陈述<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h2>
<p>目前软件测试行业的理论和细分领域层出不穷，主要包括以下几方面：</p>
<ol class="arabic simple">
<li>判定测试</li>
<li>压力测试</li>
<li>响应测试</li>
<li>安全测试</li>
</ol>
<p>本文只讲 <strong>判定测试</strong> 这个领域的内容。</p>
<p>所谓的 <strong>判定测试</strong> 包括如下几类：</p>
<ol class="arabic simple">
<li>界面自动化</li>
<li>接口自动化</li>
<li>单元自动化</li>
</ol>
<p>其实这就是 <strong>分层自动化金字塔</strong> 中的三层。</p>
<img alt="../_images/auto-test-by-layer.png" src="../_images/auto-test-by-layer.png" />
<p>它们的共同点就是：对于一个定义数据和定义的执行过程通常会有一个预期输出，如果实际输出和预期输出不同，则定义为Flase，否则为True。</p>
<p>所以，基于以上特点，都可以归结到 “判定测试” 的概念里面来，可以生成一样的 测试报告产出物，都适用于本文提到的 <strong>xtest系统</strong> 。</p>
<p>此处的 <strong>判定测试</strong> 的测试场景和类别包括且不限于：</p>
<ol class="arabic simple">
<li>单元测试</li>
<li>接口测试</li>
<li>UI测试</li>
<li>环境测试</li>
</ol>
<p>只要是涉及到：</p>
<ol class="arabic simple">
<li>测试用例</li>
<li>测试套件</li>
<li>测试结果</li>
<li>测试详情</li>
</ol>
<p>都可以使用本系统生成报表并存储历史测试数据。</p>
</div>
<div class="section" id="id6">
<h2>良好的开发规范<a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h2>
<p>为了达到上述的预期效果，有一些基本的开发规范需要地团队共同遵守。</p>
<ol class="arabic simple">
<li>良好分层的软件系统架构</li>
<li>明确的版本管理体系</li>
<li>形成良好信息流的基础软件功能</li>
</ol>
<div class="section" id="id7">
<h3>分层架构<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h3>
<p>前面提到了 <strong>软件的分层金字塔</strong> 结构，是目前主流互联网公司的所推崇的基本结构。
很多无法推进自动化测试的软件系统，大部分问题都出在这儿了，需要好好设计一下。</p>
</div>
<div class="section" id="id8">
<h3>版本管理<a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h3>
<p>所谓的版本管理，其实目标就是：明确被测对象。</p>
<p>一个软件系统从开始到结束它的名字基本上是不会变的，但是每个时期，只要是任何代码的改变，其实它都是变化的。对外展现的是不变性，对内则一定要进行好的区分。</p>
<p>被测对象版本号的重要性。每次提测而且需要记录备案的软件系统必须是独一无二的，拥有唯一的代号，即： <strong>版本号</strong>。</p>
<p>关于版本号的命名方式，业界有很我成熟的方法，在此不再赘述。只要满足如下要求即可：</p>
<ol class="arabic simple">
<li>保证版本号的唯一性</li>
<li>从字面意思可以看得到版本的演进和迭代顺序</li>
</ol>
</div>
<div class="section" id="id9">
<h3>基础功能<a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h3>
<p>形成流畅的信息流的前提是：所有的过程尽量能够自动化。</p>
<p>对于测试人员来说，有两样东西非常重要：</p>
<ol class="arabic simple">
<li>被测对象版本号及特性信息</li>
<li>运行相关环境及软件库依赖</li>
</ol>
<p>以 <strong>服务端接口</strong> 作为被测试对象的 <strong>自动化测试</strong> 过程为例子，开发人员必须至少提供一个接口：</p>
<ul class="simple">
<li>显示应用程序内部信息的接口。</li>
</ul>
<p>对于该接口的定义，下面给出一个示范：</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>接口名称</dt>
<dd>/app-info/</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>请求方式</dt>
<dd>GET</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>输入参数</dt>
<dd>无</dd>
</dl>
</li>
</ul>
<p>返回值：</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
    <span class="s2">&quot;msg&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;server&quot;</span><span class="p">:</span> <span class="s2">&quot;tornado&quot;</span><span class="p">,</span>
        <span class="s2">&quot;req_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2017-04-19 15:38:46&quot;</span><span class="p">,</span>
        <span class="s2">&quot;app_version&quot;</span><span class="p">:</span> <span class="s2">&quot;3.17.04.18.1&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>参数说明：</p>
<ul class="simple">
<li>app_version 服务端接口应用程序版本号</li>
<li>server 服务器类型</li>
</ul>
<p>如果有其它需要关注的信息，可以随时扩展上去。</p>
<p>本文最关注的内容是 <strong>app_version 所表示的被测对象版本信息</strong> ，在上面的接口中有所体现。</p>
</div>
</div>
<div class="section" id="id10">
<h2>xtest系统接口<a class="headerlink" href="#id10" title="永久链接至标题">¶</a></h2>
<p>域名路径：</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">api</span><span class="o">.</span><span class="n">apiapp</span><span class="o">.</span><span class="n">cc</span><span class="o">/</span>
</pre></div>
</div>
<p>这些系统接口可以直接封闭到sdk当中，目前提供了python版本的sdk的demo供大家参考。</p>
<div class="section" id="id11">
<h3>认证接口<a class="headerlink" href="#id11" title="永久链接至标题">¶</a></h3>
<p>功能：生成token以授权接口的调用</p>
<p>路径：</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">testdata</span><span class="o">/</span><span class="n">api</span><span class="o">-</span><span class="n">auth</span><span class="o">/</span>
</pre></div>
</div>
<p>传入参数：</p>
<ul class="simple">
<li>app_id</li>
<li>app_key</li>
</ul>
<p>请求方法：POST</p>
<p>返回值：</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
    <span class="s2">&quot;msg&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;u_name&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;token&quot;</span><span class="p">:</span> <span class="s2">&quot;7c45fc98391311e78e1a00163e006b26&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;113.57.119.51&quot;</span><span class="p">,</span>
        <span class="s2">&quot;user_agent&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;rc_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2017-05-15 10:09:11&quot;</span><span class="p">,</span>
        <span class="s2">&quot;c_type&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
        <span class="s2">&quot;app_id&quot;</span><span class="p">:</span> <span class="s2">&quot;3832f354872411e6a7c700163e006b26&quot;</span><span class="p">,</span>
        <span class="s2">&quot;last_use_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2017-05-15 07:22:54&quot;</span><span class="p">,</span>
        <span class="s2">&quot;finger_prt&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;c_name&quot;</span><span class="p">:</span> <span class="s2">&quot;api&quot;</span><span class="p">,</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;59190dc747fc890ec5ba42e0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_del&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
        <span class="s2">&quot;cookie&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;del_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2017-05-15 10:09:11&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>其中最重要的是：</p>
<ul class="simple">
<li>token  后续进行接口调用的授权值</li>
</ul>
</div>
<div class="section" id="id12">
<h3>数据接口<a class="headerlink" href="#id12" title="永久链接至标题">¶</a></h3>
<p>xtest系统提供了报告上行接口。</p>
<p>接口路径:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">testdata</span><span class="o">/</span><span class="n">create</span><span class="o">-</span><span class="n">test</span><span class="o">-</span><span class="n">data</span><span class="o">/</span>
</pre></div>
</div>
<p>token认证: 需要，token放url里面</p>
<p>请求方式: POST</p>
<p>请求参数:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;pro_id&quot;</span><span class="p">:</span> <span class="s2">&quot;57a835c8c6e905166da94243&quot;</span><span class="p">,</span>
    <span class="s2">&quot;pro_version&quot;</span><span class="p">:</span><span class="s2">&quot;1.3.4.5&quot;</span><span class="p">,</span>
    <span class="s2">&quot;run_time&quot;</span><span class="p">:</span> <span class="mf">51.77724599838257</span><span class="p">,</span>

    <span class="s2">&quot;was_successful&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
    <span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="mi">88</span><span class="p">,</span>
    <span class="s2">&quot;skipped&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
    <span class="s2">&quot;errors&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;failures&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>

    <span class="s2">&quot;details&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;failures&quot;</span><span class="p">,</span>
            <span class="s2">&quot;note&quot;</span><span class="p">:</span> <span class="s2">&quot;AssertionError: 访问不合法,返回404&quot;</span><span class="p">,</span>
            <span class="s2">&quot;explain&quot;</span><span class="p">:</span> <span class="s2">&quot;只是用于测试的Demo,没有太多意义&quot;</span><span class="p">,</span>
            <span class="s2">&quot;test_case&quot;</span><span class="p">:</span> <span class="s2">&quot;test_nginx_config&quot;</span>
        <span class="p">},</span>
        <span class="p">{},</span>
        <span class="p">{}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>以上的请求参数分为两部分：</p>
<ol class="arabic simple">
<li>单元测试框架标准结果部分</li>
<li>自动化测试项目后期添加</li>
</ol>
<p>其中：</p>
<ul class="simple">
<li>pro_id 项目在xtest系统中的id代号</li>
<li>pro_version 被测对象的唯一版本号</li>
<li>run_time 运行所有脚本花费的时间</li>
</ul>
<p>属于自动化测试项目后期运算出来的数据，其它的则是标准的单元测试框架提供的测试结果中自带内容。</p>
<p>上传数据成功后的返回值:</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;code&quot;</span><span class="p">:</span><span class="mi">200</span><span class="p">,</span><span class="s2">&quot;msg&quot;</span><span class="p">:</span><span class="s2">&quot;success&quot;</span><span class="p">,</span><span class="s2">&quot;data&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id13">
<h2>提取测试结果<a class="headerlink" href="#id13" title="永久链接至标题">¶</a></h2>
<p>本小节以 pyunit 单元测试框架为例子，来对测试报告所需要的内容进行提取。</p>
<div class="section" id="id14">
<h3>主要内容<a class="headerlink" href="#id14" title="永久链接至标题">¶</a></h3>
<p><cite>TextTestResult</cite> 结果中包含的如下内容：</p>
<ul class="simple">
<li>errors  错误详细信息列表</li>
<li>failures  运行失败详细信息列表</li>
<li>skipped 跳过的详细信息列表</li>
<li>testsRun 运行的用例总数</li>
</ul>
<p>具体如下图所示：</p>
<img alt="../_images/xtest-xunit-result.png" src="../_images/xtest-xunit-result.png" />
</div>
<div class="section" id="id15">
<h3>具体条目<a class="headerlink" href="#id15" title="永久链接至标题">¶</a></h3>
<p>以 <cite>failures</cite> 为例子：</p>
<img alt="../_images/xtest-xunit-details.png" src="../_images/xtest-xunit-details.png" />
<p>本测试用例的描述：</p>
<p>编号 <strong>索引为0</strong> 的数据:</p>
<ul class="simple">
<li>_testMethodName  测试函数名称</li>
<li>_testMethodDoc  测试函数的文档，这里面一般陈述本测试的功能</li>
</ul>
<p>打印出来的堆栈错误信息：</p>
<ul class="simple">
<li>编号  <strong>索引为1</strong> 的数据。</li>
</ul>
</div>
<div class="section" id="id16">
<h3>提取方法<a class="headerlink" href="#id16" title="永久链接至标题">¶</a></h3>
<p>对测试结果进行内容提取，同时加入如下内容：</p>
<ol class="arabic simple">
<li>测试执行时间</li>
<li>项目ID</li>
<li>项目版本号</li>
</ol>
<p>进行标准化格式打包。</p>
<p>代码：</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dict_encode_test_results</span><span class="p">(</span><span class="n">test_results</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    将测试结果进行json编码</span>
<span class="sd">    :param test_results:</span>
<span class="sd">    :type test_results:  unittest.TestResult</span>
<span class="sd">    :return:</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">run_time</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;run_time&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">pro_id</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pro_id&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">pro_version</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pro_version&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="c1"># 主体部分</span>
    <span class="n">res_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="c1"># was_successful=True if test_results.wasSuccessful() else False,</span>
        <span class="n">was_successful</span><span class="o">=</span><span class="n">test_results</span><span class="o">.</span><span class="n">wasSuccessful</span><span class="p">(),</span>
        <span class="n">total</span><span class="o">=</span><span class="n">test_results</span><span class="o">.</span><span class="n">testsRun</span><span class="p">,</span>
        <span class="n">failures</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">test_results</span><span class="o">.</span><span class="n">failures</span><span class="p">),</span>
        <span class="n">errors</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">test_results</span><span class="o">.</span><span class="n">errors</span><span class="p">),</span>
        <span class="n">skipped</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">test_results</span><span class="o">.</span><span class="n">skipped</span><span class="p">),</span>
        <span class="n">run_time</span><span class="o">=</span><span class="n">run_time</span><span class="p">,</span>
        <span class="n">pro_id</span><span class="o">=</span><span class="n">pro_id</span><span class="p">,</span>
        <span class="n">pro_version</span><span class="o">=</span><span class="n">pro_version</span>
    <span class="p">)</span>

    <span class="c1"># 详细信息部分</span>
    <span class="n">failure_list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># 失败的内容</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">test_results</span><span class="o">.</span><span class="n">failures</span><span class="p">:</span>
        <span class="n">note_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;test_case&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_testMethodName</span><span class="p">,</span>
            <span class="s1">&#39;explain&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_testMethodDoc</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">        :return:&#39;</span><span class="p">),</span>
            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;failures&#39;</span><span class="p">,</span>
            <span class="s1">&#39;note&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">}</span>

        <span class="n">failure_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">note_data</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">test_results</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
        <span class="n">note_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;test_case&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_testMethodName</span><span class="p">,</span>
            <span class="s1">&#39;explain&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_testMethodDoc</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">        :return:&#39;</span><span class="p">),</span>
            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;errors&#39;</span><span class="p">,</span>
            <span class="s1">&#39;note&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="n">failure_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">note_data</span><span class="p">)</span>

    <span class="n">res_dict</span><span class="p">[</span><span class="s1">&#39;details&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">failure_list</span>

    <span class="k">return</span> <span class="n">res_dict</span>
</pre></div>
</div>
<p>可以提到一个如下的字典对象：</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">test_res_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;pro_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.16.10.10.1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;pro_id&quot;</span><span class="p">:</span> <span class="s2">&quot;57fa12ec47fc894ee04a2c69&quot;</span><span class="p">,</span>  <span class="c1"># 在后台管理系统中组织信息详细信息里面可以查看到:项目ID</span>
    <span class="s2">&quot;run_time&quot;</span><span class="p">:</span> <span class="mf">51.772</span><span class="p">,</span>

    <span class="s2">&quot;was_successful&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;skipped&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;errors&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;failures&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>

    <span class="s2">&quot;details&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;failures&quot;</span><span class="p">,</span>
            <span class="s2">&quot;note&quot;</span><span class="p">:</span> <span class="s2">&quot;AssertionError: 访问不合法,返回404&quot;</span><span class="p">,</span>
            <span class="s2">&quot;explain&quot;</span><span class="p">:</span> <span class="s2">&quot;只是用于测试的Demo,没有太多意义&quot;</span><span class="p">,</span>
            <span class="s2">&quot;test_case&quot;</span><span class="p">:</span> <span class="s2">&quot;test_nginx_config&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id17">
<h2>对接xtest<a class="headerlink" href="#id17" title="永久链接至标题">¶</a></h2>
<p>主要步骤如下：</p>
<ol class="arabic simple">
<li>使用微信在首页扫码进行注册或者登录</li>
<li>【资产管理】-【项目信息】查看到 <strong>项目编号</strong></li>
<li>查看 <strong>app_id</strong> 和 <strong>app_key</strong></li>
</ol>
<p>依据xtest系统提供的API进行接口调用，可将  <strong>判定测试</strong> 的结果上传到 <strong>测试报告系统服务器</strong> 数据库，即可生成 <strong>软件系统量化线路图</strong> 和 <strong>精美测试报表服务</strong> 。</p>
</div>
<div class="section" id="demo">
<h2>快速demo<a class="headerlink" href="#demo" title="永久链接至标题">¶</a></h2>
<ol class="arabic simple">
<li>微信扫码登录</li>
<li>创建一个项目</li>
<li>下载sdk-demo</li>
<li>填写自己的配置信息</li>
<li>运行demo</li>
<li>上传demo的测试结果</li>
<li>分享报告</li>
</ol>
<p>本方提供了基于 Python的Pyunit的Demo程序，大家只需要登录xtest系统，修改配置信息即可运行使用。</p>
<p>Demo地址：</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">git</span><span class="o">.</span><span class="n">oschina</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">x</span><span class="o">-</span><span class="n">utest</span><span class="o">/</span><span class="n">xtest</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">demo</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>登录xtest系统，可以查找自己项目配置查找：</p>
<p>点击项目的菜单：</p>
<img alt="../_images/xtest-client-config-0.png" src="../_images/xtest-client-config-0.png" />
<p>查看指定配置：</p>
<img alt="../_images/xtest-client-config-1.png" src="../_images/xtest-client-config-1.png" />
<p>在文件 <strong>demo.py</strong> 中替换掉原有的配置：</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="c1"># todo 在系统中注册了,组织信息中看到这个值,替换到此处</span>
<span class="n">project_id</span> <span class="o">=</span> <span class="s1">&#39;590c2a0947fc894a51f9e616&#39;</span>
<span class="n">app_id</span> <span class="o">=</span> <span class="s1">&#39;3832f354872411e6a7c700163e006b26&#39;</span>
<span class="n">app_key</span> <span class="o">=</span> <span class="s1">&#39;38342936872411e6a7c700163e006b26&#39;</span>
</pre></div>
</div>
<p>然后运行程序(基于python3.5及以上) ：</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">demo</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>运行结果如下：</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span>(py3venv) harmo@harmo-pc:~/work/workspace/xtest-python-demo$ python demo.py
FFF...
======================================================================
FAIL: test_first_hello_world_false (__main__.MyTestDemo)
用户不应该越权访问资源
----------------------------------------------------------------------
Traceback (most recent call last):
  File &quot;demo.py&quot;, line 65, in test_first_hello_world_false
    self.assertTrue(False, msg=&#39;Hello Word是失败的&#39;)
AssertionError: False is not true : Hello Word是失败的

======================================================================
FAIL: test_first_hello_world_false2 (__main__.MyTestDemo)
此处用户操作太多内容了
----------------------------------------------------------------------
Traceback (most recent call last):
  File &quot;demo.py&quot;, line 71, in test_first_hello_world_false2
    self.assertTrue(False, msg=&#39;Hello Word是失败的&#39;)
AssertionError: False is not true : Hello Word是失败的

======================================================================
FAIL: test_first_hello_world_false3 (__main__.MyTestDemo)
这个用户不是超级管理员
----------------------------------------------------------------------
Traceback (most recent call last):
  File &quot;demo.py&quot;, line 77, in test_first_hello_world_false3
    self.assertTrue(False, msg=&#39;Hello Word是失败的&#39;)
AssertionError: False is not true : Hello Word是失败的

----------------------------------------------------------------------
Ran 6 tests in 0.000s

FAILED (failures=3)
{&quot;code&quot;:200,&quot;msg&quot;:&quot;success&quot;,&quot;data&quot;:&quot;&quot;}
</pre></div>
</div>
<p>其中，最后的：</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;code&quot;</span><span class="p">:</span><span class="mi">200</span><span class="p">,</span><span class="s2">&quot;msg&quot;</span><span class="p">:</span><span class="s2">&quot;success&quot;</span><span class="p">,</span><span class="s2">&quot;data&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>的 success 表明上传报告服务器成功</p>
<p>执行完毕后，即可在自己的 xtest系统 界面看到相应的报告，并进行分享</p>
</div>
<div class="section" id="id18">
<h2>定位和展望<a class="headerlink" href="#id18" title="永久链接至标题">¶</a></h2>
<p>系统定位：</p>
<ol class="arabic simple">
<li>本系统定位为 <strong>自动化</strong> 判定测试报告系统</li>
<li>没有代码执行系统，需要自己去写测试代码本地执行</li>
<li>可以将执行系统放在Jenkins里面去自动构建触发你的执行代码，然后将测试结果显示到本系统中</li>
<li>Jenkins只能显示构建的历史，然后本系统可以显示测试的历史，刚好可以成为一个补充</li>
</ol>
<p>后续展望：</p>
<ol class="arabic simple">
<li>提供看板报表功能，将量化过程投影到公司电视墙上</li>
<li>自动化SAAS服务器再触发相应的webhook，回调到后续的系统（例如：自动化发布系统）</li>
<li>对接Jenkins等持续集成</li>
</ol>
<p>关于xtest系统，目前还有些功能在完善中，完善后再对外开放，相当于测试界人员的福利吧。换句话来说：</p>
<p>目前本系统还不对外开放，我们公司自己先用好了再说 ^_^</p>
</div>
<div class="section" id="id19">
<h2>项目过程量化图<a class="headerlink" href="#id19" title="永久链接至标题">¶</a></h2>
<img alt="../_images/xtest-project-cycle.png" src="../_images/xtest-project-cycle.png" />
<p>主要特点：</p>
<ol class="arabic simple">
<li>以测试用例的数目和失败数量来量化开发过程</li>
<li>最终失败用例数是趋向于0的</li>
<li>随着功能的增加，总的用例数原则上是一直在增长的</li>
<li>以用例成功率来衡量每个版本的发布节点</li>
</ol>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">內容目录</a></h3>
  <ul>
<li><a class="reference internal" href="#">新手入门</a><ul>
<li><a class="reference internal" href="#id2">前言</a></li>
<li><a class="reference internal" href="#id3">软件开发工作流</a></li>
<li><a class="reference internal" href="#xtest">xtest系统演示</a></li>
<li><a class="reference internal" href="#id5">测试的概念陈述</a></li>
<li><a class="reference internal" href="#id6">良好的开发规范</a><ul>
<li><a class="reference internal" href="#id7">分层架构</a></li>
<li><a class="reference internal" href="#id8">版本管理</a></li>
<li><a class="reference internal" href="#id9">基础功能</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id10">xtest系统接口</a><ul>
<li><a class="reference internal" href="#id11">认证接口</a></li>
<li><a class="reference internal" href="#id12">数据接口</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id13">提取测试结果</a><ul>
<li><a class="reference internal" href="#id14">主要内容</a></li>
<li><a class="reference internal" href="#id15">具体条目</a></li>
<li><a class="reference internal" href="#id16">提取方法</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id17">对接xtest</a></li>
<li><a class="reference internal" href="#demo">快速demo</a></li>
<li><a class="reference internal" href="#id18">定位和展望</a></li>
<li><a class="reference internal" href="#id19">项目过程量化图</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../index.html" title="上一章">欢迎查看”Xtest系统“帮助文档</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>本页</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/src/home.rst.txt"
            rel="nofollow">显示源代码</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>快速搜索</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="转向" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Harmo.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/src/home.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>